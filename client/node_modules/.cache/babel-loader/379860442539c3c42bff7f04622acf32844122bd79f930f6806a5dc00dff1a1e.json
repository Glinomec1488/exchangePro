{"ast":null,"code":"import{useState,useEffect}from'react';import{getEnv}from'../../../../utils';const url=getEnv(process.env.REACT_APP_SERVER_URL,'REACT_APP_SERVER_URL');const useHistory=()=>{const[history,setHistory]=useState([]);const getHistory=async()=>{try{const historyRes=await fetch(`${url}/transactions`).then(res=>res.json());setHistory(historyRes.map(elem=>({txHash:elem.txHash,block:elem.block,fromm:elem.fromm,to:elem.to,value:elem.value})));}catch(error){console.error(error.message);}};useEffect(()=>{if(history.length===0)getHistory();});useEffect(()=>{const timer=setInterval(()=>{fetch(`${url}/genTrans`).then(res=>res.json()).then(res=>{const slicedHistory=history.slice(0,-1);setHistory([{txHash:res.txHash,block:res.block,fromm:res.fromAddress,to:res.to,value:res.value},...slicedHistory]);});},5000);return()=>{clearInterval(timer);};});return{history};};export default useHistory;","map":{"version":3,"names":["useState","useEffect","getEnv","url","process","env","REACT_APP_SERVER_URL","useHistory","history","setHistory","getHistory","historyRes","fetch","then","res","json","map","elem","txHash","block","fromm","to","value","error","console","message","length","timer","setInterval","slicedHistory","slice","fromAddress","clearInterval"],"sources":["C:/Users/1/Videos/exchangePro-main/client/src/screens/home/components/txHistory/useHistory.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { getEnv } from '../../../../utils'\n\nconst url = getEnv(process.env.REACT_APP_SERVER_URL, 'REACT_APP_SERVER_URL')\n\nexport interface IHistoryItem {\n    block: string,\n    fromm: string,\n    to: string,\n    txHash: string,\n    value: string,\n}\n\nconst useHistory = () => {\n    const [history, setHistory] = useState<IHistoryItem[]>([])\n\n    const getHistory = async () => {\n        try {\n            const historyRes: IHistoryItem[] = await fetch(`${url}/transactions`).then(res => res.json())\n            setHistory(historyRes.map(elem => (\n                {\n                    txHash: elem.txHash,\n                    block: elem.block,\n                    fromm: elem.fromm,\n                    to: elem.to,\n                    value: elem.value\n                }\n            )))\n        } catch (error: any) {\n            console.error(error.message)\n        }\n    }\n\n    useEffect(() => {\n        if (history.length === 0) getHistory()\n    })\n\n    useEffect(() => {\n        const timer = setInterval(() => {\n            fetch(`${url}/genTrans`)\n                .then(res => res.json())\n                .then(res => {\n                    const slicedHistory = history.slice(0, -1)\n                    setHistory([\n                        {\n                            txHash: res.txHash,\n                            block: res.block,\n                            fromm: res.fromAddress,\n                            to: res.to,\n                            value: res.value\n                        },\n                        ...slicedHistory\n                    ])\n                })\n        }, 5000)\n\n        return () => {\n            clearInterval(timer)\n        }\n    })\n\n    return {\n        history\n    }\n}\n\nexport default useHistory"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,MAAM,KAAQ,mBAAmB,CAE1C,KAAM,CAAAC,GAAG,CAAGD,MAAM,CAACE,OAAO,CAACC,GAAG,CAACC,oBAAoB,CAAE,sBAAsB,CAAC,CAU5E,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACrB,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAiB,EAAE,CAAC,CAE1D,KAAM,CAAAU,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CACA,KAAM,CAAAC,UAA0B,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGT,GAAG,eAAe,CAAC,CAACU,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAC7FN,UAAU,CAACE,UAAU,CAACK,GAAG,CAACC,IAAI,GAC1B,CACIC,MAAM,CAAED,IAAI,CAACC,MAAM,CACnBC,KAAK,CAAEF,IAAI,CAACE,KAAK,CACjBC,KAAK,CAAEH,IAAI,CAACG,KAAK,CACjBC,EAAE,CAAEJ,IAAI,CAACI,EAAE,CACXC,KAAK,CAAEL,IAAI,CAACK,KAChB,CAAC,CACJ,CAAC,CAAC,CACP,CAAE,MAAOC,KAAU,CAAE,CACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAACE,OAAO,CAAC,CAChC,CACJ,CAAC,CAEDxB,SAAS,CAAC,IAAM,CACZ,GAAIO,OAAO,CAACkB,MAAM,GAAK,CAAC,CAAEhB,UAAU,CAAC,CAAC,CAC1C,CAAC,CAAC,CAEFT,SAAS,CAAC,IAAM,CACZ,KAAM,CAAA0B,KAAK,CAAGC,WAAW,CAAC,IAAM,CAC5BhB,KAAK,CAAC,GAAGT,GAAG,WAAW,CAAC,CACnBU,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAACC,GAAG,EAAI,CACT,KAAM,CAAAe,aAAa,CAAGrB,OAAO,CAACsB,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC,CAC1CrB,UAAU,CAAC,CACP,CACIS,MAAM,CAAEJ,GAAG,CAACI,MAAM,CAClBC,KAAK,CAAEL,GAAG,CAACK,KAAK,CAChBC,KAAK,CAAEN,GAAG,CAACiB,WAAW,CACtBV,EAAE,CAAEP,GAAG,CAACO,EAAE,CACVC,KAAK,CAAER,GAAG,CAACQ,KACf,CAAC,CACD,GAAGO,aAAa,CACnB,CAAC,CACN,CAAC,CAAC,CACV,CAAC,CAAE,IAAI,CAAC,CAER,MAAO,IAAM,CACTG,aAAa,CAACL,KAAK,CAAC,CACxB,CAAC,CACL,CAAC,CAAC,CAEF,MAAO,CACHnB,OACJ,CAAC,CACL,CAAC,CAED,cAAe,CAAAD,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}