{"ast":null,"code":"import{useEffect}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{serveUrl}from\"../config\";import{useAppDispatch,useAppSelector}from\"../store/hooks\";import{dispatchOrder}from\"../store/slices/exchange\";import{io}from\"socket.io-client\";const useOrderInfo=()=>{const{orderId}=useParams();const order=useAppSelector(state=>state.exchange.orderInfo);const dispatch=useAppDispatch();const navigate=useNavigate();const getOrder=async()=>{const order=await fetch(`${serveUrl}/order/${orderId}`).then(res=>res.json());if(order.error){navigate(\"/\");}dispatch(dispatchOrder(order));};const confirmOrder=async()=>{try{await fetch(`${serveUrl}/confirm/${orderId}`,{method:\"POST\"}).then(res=>res.json());window.location.reload();}catch(error){console.error(error.message);}};useEffect(()=>{if(!order){getOrder();}});useEffect(()=>{const socket=io(serveUrl);socket.on(`redirect_user_${orderId}`,async()=>{try{await fetch(`${serveUrl}/confirm/${orderId}/passed`,{method:\"POST\"}).then(res=>res.json());window.location.reload();}catch(error){console.error(error.message);}});});return{orderInfo:order,orderId,confirmOrder};};export default useOrderInfo;","map":{"version":3,"names":["useEffect","useNavigate","useParams","serveUrl","useAppDispatch","useAppSelector","dispatchOrder","io","useOrderInfo","orderId","order","state","exchange","orderInfo","dispatch","navigate","getOrder","fetch","then","res","json","error","confirmOrder","method","window","location","reload","console","message","socket","on"],"sources":["C:/Users/1/Videos/exchangePro-main/client/src/hooks/useOrderInfo.ts"],"sourcesContent":["import { useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { serveUrl } from \"../config\";\nimport { useAppDispatch, useAppSelector } from \"../store/hooks\";\nimport { dispatchOrder } from \"../store/slices/exchange\";\nimport { io } from \"socket.io-client\";\n\nconst useOrderInfo = () => {\n  const { orderId } = useParams();\n  const order = useAppSelector((state) => state.exchange.orderInfo);\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  const getOrder = async () => {\n    const order = await fetch(`${serveUrl}/order/${orderId}`).then((res) =>\n      res.json()\n    );\n\n    if (order.error) {\n      navigate(\"/\");\n    }\n\n    dispatch(dispatchOrder(order));\n  };\n\n  const confirmOrder = async () => {\n    try {\n      await fetch(`${serveUrl}/confirm/${orderId}`, {\n        method: \"POST\",\n      }).then((res) => res.json());\n      window.location.reload();\n    } catch (error: any) {\n      console.error(error.message);\n    }\n  };\n\n  useEffect(() => {\n    if (!order) {\n      getOrder();\n    }\n  });\n\n  useEffect(() => {\n    const socket = io(serveUrl);\n\n    socket.on(`redirect_user_${orderId}`, async () => {\n      try {\n        await fetch(`${serveUrl}/confirm/${orderId}/passed`, {\n          method: \"POST\",\n        }).then((res) => res.json());\n        window.location.reload();\n      } catch (error: any) {\n        console.error(error.message);\n      }\n    });\n  });\n\n  return {\n    orderInfo: order,\n    orderId,\n    confirmOrder,\n  };\n};\n\nexport default useOrderInfo;\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACzD,OAASC,QAAQ,KAAQ,WAAW,CACpC,OAASC,cAAc,CAAEC,cAAc,KAAQ,gBAAgB,CAC/D,OAASC,aAAa,KAAQ,0BAA0B,CACxD,OAASC,EAAE,KAAQ,kBAAkB,CAErC,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAEC,OAAQ,CAAC,CAAGP,SAAS,CAAC,CAAC,CAC/B,KAAM,CAAAQ,KAAK,CAAGL,cAAc,CAAEM,KAAK,EAAKA,KAAK,CAACC,QAAQ,CAACC,SAAS,CAAC,CACjE,KAAM,CAAAC,QAAQ,CAAGV,cAAc,CAAC,CAAC,CACjC,KAAM,CAAAW,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAe,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,KAAM,CAAAN,KAAK,CAAG,KAAM,CAAAO,KAAK,CAAC,GAAGd,QAAQ,UAAUM,OAAO,EAAE,CAAC,CAACS,IAAI,CAAEC,GAAG,EACjEA,GAAG,CAACC,IAAI,CAAC,CACX,CAAC,CAED,GAAIV,KAAK,CAACW,KAAK,CAAE,CACfN,QAAQ,CAAC,GAAG,CAAC,CACf,CAEAD,QAAQ,CAACR,aAAa,CAACI,KAAK,CAAC,CAAC,CAChC,CAAC,CAED,KAAM,CAAAY,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAL,KAAK,CAAC,GAAGd,QAAQ,YAAYM,OAAO,EAAE,CAAE,CAC5Cc,MAAM,CAAE,MACV,CAAC,CAAC,CAACL,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAC5BI,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAE,MAAOL,KAAU,CAAE,CACnBM,OAAO,CAACN,KAAK,CAACA,KAAK,CAACO,OAAO,CAAC,CAC9B,CACF,CAAC,CAED5B,SAAS,CAAC,IAAM,CACd,GAAI,CAACU,KAAK,CAAE,CACVM,QAAQ,CAAC,CAAC,CACZ,CACF,CAAC,CAAC,CAEFhB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6B,MAAM,CAAGtB,EAAE,CAACJ,QAAQ,CAAC,CAE3B0B,MAAM,CAACC,EAAE,CAAC,iBAAiBrB,OAAO,EAAE,CAAE,SAAY,CAChD,GAAI,CACF,KAAM,CAAAQ,KAAK,CAAC,GAAGd,QAAQ,YAAYM,OAAO,SAAS,CAAE,CACnDc,MAAM,CAAE,MACV,CAAC,CAAC,CAACL,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAC5BI,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAE,MAAOL,KAAU,CAAE,CACnBM,OAAO,CAACN,KAAK,CAACA,KAAK,CAACO,OAAO,CAAC,CAC9B,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF,MAAO,CACLf,SAAS,CAAEH,KAAK,CAChBD,OAAO,CACPa,YACF,CAAC,CACH,CAAC,CAED,cAAe,CAAAd,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}